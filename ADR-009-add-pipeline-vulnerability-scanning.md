# ADR-009 Default Enabling of Vulnerability Scanning in Pipelines

Date: 2024-03-27

## Status

In Review

## Context

To enhance security and code quality, it is crucial to address source code vulnerabilities and security issues during the build process, before pushing to storage (S3/ECR) or deploying applications. This proactive approach prevents overwhelming security teams with Common Vulnerabilities and Exposures (CVEs) that need resolution post-deployment. 

## Decision

- Enable vulnerability scanning by default on all pipelines to detect and remediate CVEs early
- Utilize [Trivy](https://trivy.dev/latest/) as the chosen tool for container and filesystem scanning
- Implement this scanning at the build stage to enforce proactive security measures

## Consequences

### Positive

- Detecting and remediating vulnerabilities during the build stage helps prevent potential security breaches.
- Regular scanning identifies potential issues early, enhancing overall code quality.
- Early detection and resolution of vulnerabilities reduce the workload on security teams and prevent overwhelming them with production issues.
- Fewer CVEs in production accounts lead to reduced security risk and an improved overall security posture.

### Negative

- Enabling scanning may increase build times. This trade-off for improved security and code quality can be mitigated by parallelizing builds where possible.
- Developers may require training to interpret and act on scan results effectively.
- Regular updates and maintenance of Trivy are necessary to keep it current with the latest vulnerabilities. This can be managed through pipeline templates maintained in a centralized repository.
- Trivy may produce false positives, requiring additional investigation. To address this, vulnerabilities should be reviewed promptly. If blocking critical features, developers can temporarily suspend failures by adding CVEs to the `.trivyignore` file with an expiration date and a work item link to ensure resolution within a recommended two-week period.