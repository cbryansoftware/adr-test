# Default Enabling of Vulnerability Scanning in Pipelines

* Status: Proposed
* Date: 2024-03-27

## Context and Problem Statement

To enhance security and code quality, it is crucial to address source code vulnerabilities and security issues during the build process, before pushing to storage (S3/ECR) or deploying applications. How can we ensure vulnerabilities are detected and remediated early to prevent overwhelming security teams with post-deployment CVEs?

## Considered Options

* Enable vulnerability scanning by default in all pipelines
* Perform vulnerability scanning post-deployment
* Rely on manual vulnerability checks by developers

## Decision Outcome

Chosen option: "Enable vulnerability scanning by default in all pipelines," using Trivy for container and filesystem scanning at the build stage to enforce proactive security measures.

### Positive Consequences

* Detecting and remediating vulnerabilities during the build stage helps prevent potential security breaches.
* Regular scanning identifies potential issues early, enhancing overall code quality.
* Early detection and resolution of vulnerabilities reduce the workload on security teams and prevent overwhelming them with production issues.
* Fewer CVEs in production accounts lead to reduced security risk and an improved overall security posture.

### Negative Consequences

* May increase build times, mitigated by parallelizing builds where possible.
* Developers may require training to interpret and act on scan results effectively.
* Regular updates and maintenance of Trivy are necessary to keep it current with the latest vulnerabilities, managed through pipeline templates in a centralized repository.
* Trivy may produce false positives, requiring additional investigation. Vulnerabilities should be reviewed promptly, with temporary suspensions managed via `.trivyignore` files, including expiration dates and work item links for resolution within two weeks.
